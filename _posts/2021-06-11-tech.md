---
title: Технічні питання
date: 2021-06-11 04:27:00 +03:00
---

Занотую, що я тут роблю цікавого.


PhotoSwipe
----------

Нарешті, я це зробив! Я підключив чудову [бібліотеку PhotoSwipe][1], і тепер гортати фотки стало зручніше. Взяв стабільну гілку 4.x, бо вона потенційно працює на моєму антикварному iPad 2 з антикварною Safari 9. (Насправді ніт, поки не вийшло).

Довелося досить серйозно переробити створення зображень для попереднього перегляду, та і взагалі всю мою хімію з ImageMagick'ом. Раніше попередній перегляд складався з справжніх квадратних зображень, обрубаних до 300×300 пікселів; тепер ці файли мають розмір 300×400 чи 400×300, а CSS зменшує їх до квадрата (чудово, що є [`object-fit: cover`][2]). Чому саме так? Бо це потрібно для коректної роботи анімації у PhotoSwipe.

Що я планую зробити якось потім: генерувати «середні» за розміром зображення (не більше ніж 1200×1200 пікселів) і динамічно обмежувати великі картинки на маленьких пристроях. Бо більшість моїх фото має розмір 4032×3024, клятих 12 мегапікселів! Що занадто, то не варто.


Dashboard та веб-камери
-----------------------

У мене є, так би мовити, dashboard. Доступний у моїй локальній мережі за адресою <http://dashboard.rico.home> :) Там можна подивитися рівень вологи ґрунту у горщику A0 і температуру, причому рівень вологості ще треба якось інтерпретувати.

Інші датчики цього типу показують ~520 у повітрі та ~220 у склянці з водою. Скільки воно покаже у сухому ґрунті? Скільки у вологому? Хрін його зна, треба більше експериментів.

Емпірично я вивів собі деякі правила. Коли рівень нижче 250, то це перелив (добре хоч дренаж рятує). Коли десь 280, то це нормальний рівень. При цифрі 300 у мене починають чухатися руки. 320 — точно причина для поливу, але без зайвого поспіху. Якщо цифра вище 350, то треба все кидати та бігти поливати томати.

Визнаю, цей dashboard аж ніяк не тягне на звання шедевру веб-програмування. Так би мовити, є що вдосконалювати. А ось «моментальна веб-камера» вийшла непогано.

<img src="dashboard.png" style="max-width: 100%" alt="Знімок екрана: dashboard">
<img src="webcam.jpg" style="max-width: 100%" alt="Знімок екрана: веб-камера">

Знімки з двох веб-камер раз на п'ять хвилин автоматично робляться скриптами та зберігаються на `//RICO/WHATEVER`. Це робить crontab на тій Raspberry Pi, до якої підключені всі ці камери. Виходить прикольний архів.

А що як я пузом зачеплю одну з камер і захочу повернути камеру на місце, як було? (Приклад ніфіга не теоретичний). Тож мені потрібен _додатковий_ інструмент, який показує зображення негайно, саме тоді, коли воно потрібне.

Ну, я і зробив штуку, яка сама _лізе куди хоче по ssh_ і там робить знімок. Аж страшно! Зображення оновлюються вручну, по кліку у довільному місці, з красивими CSS та JS.


Нова збірка Arduino
-------------------

А тут, на жаль, прогрес поки що зупинився. Якось я туплю — дивлюся на конектори DuPont та XH2.54, на клемні колодки пружинні та гвинтові, і не знаю, як же зробити нормально.

Треба думати.

[1]: https://photoswipe.com/
[2]: https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit
